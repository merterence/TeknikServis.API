@{
    ViewData["Title"] = "Giriş Yap";
}

<h2>Giriş Yap </h2>

<form asp-area="" asp-controller="Kullanici" asp-action="Login" method="post">
    <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" class="form-control" name="email" required />
    </div>

    <div class="mb-3">
        <label for="sifre" class="form-label">Şifre</label>
        <input type="password" class="form-control" name="sifre" required />
    </div>

    <div class="form-check mb-3">
        <input type="checkbox" class="form-check-input" id="beniHatirla" name="beniHatirla">
        <label class="form-check-label" for="beniHatirla">Beni hatırla</label>
    </div>

    <button type="submit" class="btn btn-primary">Giriş Yap</button>
</form>

@if (ViewBag.Mesaj != null)
{
    <div class="alert alert-danger mt-3">@ViewBag.Mesaj</div>
}

<!-- 🍪 Sayfa yüklendiğinde cookie varsa inputları otomatik doldur -->
<script>
    window.onload = function () {
        var email = getCookie("email");
        var sifre = getCookie("sifre");

        if (email && sifre) {
            document.getElementById("email").value = email;
            document.getElementById("sifre").value = sifre;
            document.getElementById("beniHatirla").checked = true;
        }
    }

    function getCookie(name) {
        var match = document.cookie.match(new RegExp("(^| )" + name + "=([^;]+)"));
        if (match) return decodeURIComponent(match[2]);
        return null;
    }
</script>

<!-- ✅ Login başarılı olduktan sonra kullanıcı ID'sini LocalStorage'a kaydediyoruz -->
@if (TempData["kullaniciId"] != null)
{
    <script>
        localStorage.setItem("kullaniciId", "@TempData["kullaniciId"]");
    </script>
}
